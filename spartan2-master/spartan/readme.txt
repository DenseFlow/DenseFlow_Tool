here is the code we use based on the code spartan
